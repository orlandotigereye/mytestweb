<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>é‡‘ç¢§è¼ç…Œ Â· G-CORE 4.5</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://d3js.org/d3.v7.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/astronomy-engine@latest/astronomy.browser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<script src="./core-loader.js"></script>

<style>
body{font-size:12px;background:#FFFDF0;padding:16px}
.item{border:1px solid #C5A059;border-radius:8px;padding:10px;margin-bottom:6px}
.ok{color:green;font-weight:bold}
.fail{color:red;font-weight:bold}
</style>
</head>

<body>

<h2>âšœï¸ æ ¸å¿ƒè¨ºæ–·</h2>
<div id="diag"></div>

<h2>ğŸ“¡ API æ¸¬è©¦</h2>
<textarea id="txt" style="width:100%;height:120px">æ¸¬è©¦ JSON å›å‚³</textarea>
<button onclick="run()">å‘¼å« API</button>

<pre id="out"></pre>

<script>
Core.load({
  apiUrl:"./config/api.js",
  cjkUrl:"https://raw.githubusercontent.com/orlandotigereye/mytestweb/4ea567726353330f2301bca768a6325ab5611699/public/public/Dictionary_lite.json",
  astroUrl:"https://raw.githubusercontent.com/orlandotigereye/Analy13/refs/heads/main/astrology_merged.json"
}, (k, ok)=>{
  $("#diag").append(
    `<div class="item">${k} :
     <span class="${ok?"ok":"fail"}">${ok?"OK":"FAIL"}</span></div>`
  );
});

/* ===== APIï¼ˆè‡ªå‹•é™ç´šï¼‰ ===== */
async function run(){
  if(!Core.status.api?.ok){
    alert("API KEY ä¸å¯ç”¨");
    return;
  }

  const res = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${Core.apiKey}`,
    {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({
        contents:[{parts:[{text:$("#txt").val()}]}]
      })
    }
  );

  const j = await res.json();
  $("#out").text(j.candidates[0].content.parts[0].text);
}
</script>

</body>
</html>
